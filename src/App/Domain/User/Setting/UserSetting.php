<?phpnamespace App\Domain\User\Setting;use function App\addLog;use App\Common\CommonDomain;use App\Common\Exception\WrongRequestException;use App\Model\User\Setting\UserSetting as ModelSetting;/** * 用户配置类 * * @author lws */class UserSetting extends CommonDomain{    private static $Model = null;    public function __construct()    {        if (self::$Model == null) {            self::$Model = new ModelSetting();        }    }    public function getSetting($name)    {        return json_decode(self::$Model->getInfo(array('name'=>$name))['value']);    }    public function doSetting($name,$data)    {        $param = json_decode($data);        if($name == 'base_setting'){            if (!is_numeric($param->user_name_length_min) or $param->user_name_length_min <= 0) {                throw new WrongRequestException('用户名最小长度不合法', 1);            }            if (!is_numeric($param->user_name_length_max) or $param->user_name_length_max <= 0) {                throw new WrongRequestException('用户名最大长度不合法', 2);            }            if (!is_numeric($param->nick_name_length_min) or $param->nick_name_length_min <= 0) {                throw new WrongRequestException('用户昵称最小长度不合法', 3);            }            if (!is_numeric($param->nick_name_length_max) or $param->nick_name_length_max <= 0) {                throw new WrongRequestException('用户昵称最小长度不合法', 4);            }            if (!is_numeric($param->password_length_min) or $param->password_length_min <= 0) {                throw new WrongRequestException('用户密码最小长度不合法', 4);            }            if (!is_numeric($param->password_length_max) or $param->password_length_max <= 0) {                throw new WrongRequestException('用户昵称最小大度不合法', 4);            }            if (count($param->default_user_group_list) <= 0) {                throw new WrongRequestException('请至少选择一个默认用户组', 5);            }        }        $result = self::$Model->updateByWhere(array('name'=>$name),array('value'=>$data));        if ($result === false) {            throw new WrongRequestException('保存失败', 6);        }        addLog('修改用户配置，配置项：' . $name);    }}